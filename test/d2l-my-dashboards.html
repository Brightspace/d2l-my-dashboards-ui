<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">
		<title>d2l-my-dashboards test</title>

		<script src="../../webcomponentsjs/webcomponents-lite.js"></script>
		<script src="../../lie/dist/lie.polyfill.min.js"></script>
		<script src="../../web-component-tester/browser.js"></script>
		<link rel="import" href="../d2l-my-dashboards.html">
	</head>
	<body>
		<test-fixture id="d2l-my-dashboards-fixture">
			<template>
				<d2l-my-dashboards></d2l-my-dashboards>
			</template>
		</test-fixture>
		<script>
			suite('d2l-my-dashboards', function() {
				const mockData = [
					{ imgUrl: 'Image1', name: 'Name1' },
					{ imgUrl: 'Image2', name: 'Name2' }
				];
				window.d2lfetch = {
					fetch: function() {
						return Promise.resolve({
							ok: true,
							json: function() {
								return Promise.resolve({
									value: mockData
								});
							}
						});
					}
				};

				let element;
				setup(function(done) {
					element = fixture('d2l-my-dashboards-fixture');
					flush(done);
				});

				test('instantiating the element works', function() {
					assert.equal(element.is, 'd2l-my-dashboards');
				});

				test('after fetching dashboards, the correct number of image tiles are displayed', function(done) {
					element._fetchDashboards().then(function() {
						const innerRoot = element.shadowRoot ? element.shadowRoot : element;
						const d2lImageTiles = innerRoot.querySelectorAll('d2l-image-tile');

						assert.equal(d2lImageTiles.length, mockData.length);
						done();
					});
				});
			});
		</script>
	</body>
</html>
